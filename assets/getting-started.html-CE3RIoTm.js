import{_ as i,c as o,b as a,a as s,d as n,e as l,w as r,r as c,o as p}from"./app-DsY0HySA.js";const u="/shipjs/assets/setup-rESOHHLC.png",d="/shipjs/assets/automation-token-XFWi_sWw.png",m={},h={class:"hint-container warning"};function g(b,e){const t=c("RouteLink");return p(),o("div",null,[e[5]||(e[5]=a("h1",{id:"getting-started",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#getting-started"},[a("span",null,"Getting Started")])],-1)),e[6]||(e[6]=a("p",null,"You can following the guide below, or watch this video.",-1)),e[7]||(e[7]=a("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/FPj7urChN_E",frameborder:"0",allow:"autoplay; encrypted-media",allowfullscreen:""},null,-1)),e[8]||(e[8]=s(`<h2 id="installation" tabindex="-1"><a class="header-anchor" href="#installation"><span>Installation</span></a></h2><p>Running the following command will guide you to set it up interactively.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">npx shipjs setup</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>This interactive CLI will help you install Ship.js into your package and create a tailored config file for your project.</p><p><img src="`+u+`" alt="npx shipjs setup"></p><p>Otherwise, you can still do it manually.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">npm</span> <span class="token function">install</span> --save-dev shipjs</span>
<span class="line"></span>
<span class="line">or</span>
<span class="line"></span>
<span class="line"><span class="token function">yarn</span> <span class="token function">add</span> <span class="token parameter variable">-D</span> shipjs</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Add the following to the <code>scripts</code> section in your <code>package.json</code>.</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">&quot;scripts<span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">//...</span></span>
<span class="line">  <span class="token string-property property">&quot;release&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shipjs prepare&quot;</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="github-token" tabindex="-1"><a class="header-anchor" href="#github-token"><span>GitHub Token</span></a></h3>`,10)),a("div",h,[e[3]||(e[3]=s(`<p class="hint-container-title">If you use Ship.js at work, I recommend you to get a token from a shared account, not from your personal account because after you quit, your token will still be used. :::</p><p>GitHub token is used in both <code>shipjs prepare</code> and <code>shipjs trigger</code>.</p><ol><li>Go to <a href="https://github.com/settings/tokens/new" target="_blank" rel="noopener noreferrer">https://github.com/settings/tokens/new</a></li><li>Check &quot;repo(Full control of private repositories)&quot;</li><li>Generate/copy the token</li></ol><p>You can put it in the following two ways:</p><ul><li>Prepend it in your command like: <code>GITHUB_TOKEN=xxx shipjs prepare</code></li><li>Create a file named &quot;.env&quot; and put the following content: <code>GITHUB_TOKEN=xxx</code> (&quot;.env&quot; should not be committed. Add it to &quot;.gitignore&quot;.)</li></ul><p>If you automate flows in your CI, you can add the token to Environment Variable section in your CI service.</p><h3 id="dry-mode" tabindex="-1"><a class="header-anchor" href="#dry-mode"><span>Dry Mode</span></a></h3><p>If you&#39;re not sure, you can always run commands in dry mode.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">yarn</span> run release --dry-run</span>
<span class="line"><span class="token comment"># or</span></span>
<span class="line"><span class="token function">npm</span> run release -- --dry-run</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>It will show you which steps are going to be executed without actually executing them.</p><h2 id="on-your-local-machine" tabindex="-1"><a class="header-anchor" href="#on-your-local-machine"><span>On your local machine</span></a></h2><ul><li>Part 1: <code>yarn run release</code> will create a pull request.</li><li>Part 2: Review and merge the PR.</li><li>Part 3: <code>git pull</code> and <code>yarn shipjs trigger</code>(or <code>npx shipjs trigger</code>) to actually publish it to NPM.</li></ul><h2 id="automate-part-3-trigger" tabindex="-1"><a class="header-anchor" href="#automate-part-3-trigger"><span>Automate Part 3 (<code>trigger</code>)</span></a></h2><p>This guide is based on CircleCI. It may be done similarly on other CI services.</p>`,14)),a("p",null,[e[1]||(e[1]=n("If you are using GitHub Actions, you can jump to ",-1)),l(t,{to:"/guide/getting-started.html#setup-github-actions"},{default:r(()=>[...e[0]||(e[0]=[n("Setup GitHub Actions",-1)])]),_:1}),e[2]||(e[2]=n(".",-1))]),e[4]||(e[4]=s(`<p>A minimal <code>.circleci/config.yml</code> looks like the following:</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token number">2</span></span>
<span class="line"><span class="token key atrule">jobs</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">shipjs_trigger</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">docker</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> <span class="token string">&#39;circleci/node:latest&#39;</span></span>
<span class="line">    <span class="token key atrule">steps</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> checkout</span>
<span class="line">      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span></span>
<span class="line">          <span class="token key atrule">name</span><span class="token punctuation">:</span> Install</span>
<span class="line">          <span class="token key atrule">command</span><span class="token punctuation">:</span> yarn install</span>
<span class="line">      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span></span>
<span class="line">          <span class="token key atrule">name</span><span class="token punctuation">:</span> Triggering Ship.js to Release</span>
<span class="line">          <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string"></span>
<span class="line">            git config --global user.email &quot;you@example.com&quot;</span>
<span class="line">            git config --global user.name &quot;Your Name&quot;</span>
<span class="line">            yarn shipjs trigger</span></span>
<span class="line"><span class="token key atrule">workflows</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token number">2</span></span>
<span class="line">  <span class="token key atrule">release_if_needed</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">jobs</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token key atrule">shipjs_trigger</span><span class="token punctuation">:</span></span>
<span class="line">          <span class="token key atrule">filters</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token key atrule">branches</span><span class="token punctuation">:</span></span>
<span class="line">              <span class="token key atrule">only</span><span class="token punctuation">:</span></span>
<span class="line">                <span class="token punctuation">-</span> master <span class="token comment"># or whatever branch you&#39;d like (normally your base branch)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>At Part 2, if you merge the PR, a new commit will be added and CircleCI will run <code>yarn shipjs trigger</code>(or <code>npx shipjs trigger</code>). Then, it will check if the latest commit message is in convention and the current branch is right. If the conditions are met, it will trigger a release. Otherwise, it will skip.</p><p>When merging a PR, you need to &quot;Squash and merge&quot; into a single commit.</p><p>You can go to &quot;Settings&quot; menu of your repository, and even force &quot;Squash and merge&quot; behavior under &quot;Merge button&quot; section.</p><p>To learn more, you can read <a href="https://help.github.com/en/github/collaborating-with-issues-and-pull-requests/about-pull-request-merges#squash-and-merge-your-pull-request-commits" target="_blank" rel="noopener noreferrer">this</a>.</p><h3 id="npm-token" tabindex="-1"><a class="header-anchor" href="#npm-token"><span>NPM Token</span></a></h3><p>Setup an NPM token to allow Ship.js(<strong>at CircleCI</strong>) to release the package to NPM.</p><ol><li>Login at <a href="https://www.npmjs.com/" target="_blank" rel="noopener noreferrer">https://www.npmjs.com/</a>, click your profile icon and go to &quot;Tokens&quot;.</li><li>Click &quot;Create New Token&quot;, make sure the access level is &quot;Read and Publish&quot; and copy the token.</li><li>At CircleCI, go to &quot;Project Settings&quot; → &quot;BUILD SETTINGS&quot; → &quot;Environment Variables&quot;.</li><li>Click &quot;Add Variable&quot;. <ul><li>Name: <code>NPM_AUTH_TOKEN</code></li><li>Value: Paste the token from clipboard.</li></ul></li></ol><div class="hint-container warning"><p class="hint-container-title">WARNING for 2FA If you have enabled 2FA for both authorization and publishing, when <code>shipjs trigger</code> runs, it will be prompted for one-time password. You probably have configured CI service (CircleCI, GitHub Actions, etc) to run that command for you. It means <code>shipjs trigger</code> will be stuck.</p><p>NPM has <a href="https://github.blog/changelog/2020-10-02-npm-automation-tokens/" target="_blank" rel="noopener noreferrer">released</a> a new feature &quot;Automation token&quot; to solve this.</p><p><img src="`+d+'" alt="NPM automation token"> :::</p><h3 id="github-token-1" tabindex="-1"><a class="header-anchor" href="#github-token-1"><span>GitHub Token</span></a></h3><p>Setup a GitHub token to allow Ship.js(<strong>at CircleCI</strong>) to create a git tag and push it to remote after release.</p><ol><li>Go to https://github.com/settings/tokens/new</li><li>Check &quot;repo(Full control of private repositories)&quot;</li><li>Generate/copy the token</li><li>At CircleCI, go to &quot;Project Settings&quot; → &quot;BUILD SETTINGS&quot; → &quot;Environment Variables&quot;.</li><li>Click &quot;Add Variable&quot;. <ul><li>Name: <code>GITHUB_TOKEN</code></li><li>Value: Paste the token from clipboard.</li></ul></li></ol><h2 id="setup-github-actions" tabindex="-1"><a class="header-anchor" href="#setup-github-actions"><span>Setup GitHub Actions</span></a></h2><p>If you are using GitHub Actions, you need to setup the NPM token to release package to NPM:</p><ol><li>Login at <a href="https://www.npmjs.com/" target="_blank" rel="noopener noreferrer">https://www.npmjs.com/</a>, click your profile icon and go to &quot;Auth Tokens&quot;.</li><li>Click &quot;Create New Token&quot;, make sure the access level is &quot;Read and Publish&quot; and copy the token.</li><li>At your GitHub repo, go to &quot;Settings&quot; → &quot;Secrets&quot;.</li><li>Click &quot;Add a new secret&quot;. <ul><li>Name: <code>NPM_AUTH_TOKEN</code></li><li>Value: Paste the token from clipboard.</li></ul></li></ol><h2 id="setup-with-nothing" tabindex="-1"><a class="header-anchor" href="#setup-with-nothing"><span>Setup with &#39;Nothing&#39;</span></a></h2><p>If you never use any CI environment, you need to use NPM token to release package to NPM:</p><ol><li>Login at <a href="https://www.npmjs.com/" target="_blank" rel="noopener noreferrer">https://www.npmjs.com/</a>, click your profile icon and go to &quot;Auth Tokens&quot;.</li><li>Click &quot;Create New Token&quot;, make sure the access level is &quot;Read and Publish&quot; and copy the token.</li></ol><p>You can put it in the following two ways:</p><ul><li>Prepend it in your command like: <code>NPM_AUTH_TOKEN=xxx shipjs trigger</code></li><li>Create a file named &quot;.env&quot; and put the following content: <code>NPM_AUTH_TOKEN=xxx</code> (&quot;.env&quot; should not be committed. Add it to &quot;.gitignore&quot;.)</li></ul></div>',10))])])}const v=i(m,[["render",g]]),f=JSON.parse('{"path":"/guide/getting-started.html","title":"Getting Started","lang":"en-US","frontmatter":{},"git":{"updatedTime":1692863988000,"contributors":[{"name":"Eunjae Lee","username":"","email":"eunjae.lee@algolia.com","commits":9},{"name":"Dmitry Ivakhnenko","username":"","email":"jeetiss@yandex.ru","commits":2},{"name":"shipjs","username":"shipjs","email":"shipjs@test.com","commits":7,"url":"https://github.com/shipjs"},{"name":"lulzneko","username":"lulzneko","email":"lulzneko@riotz.works","commits":1,"url":"https://github.com/lulzneko"},{"name":"dhayab","username":"dhayab","email":"154633+dhayab@users.noreply.github.com","commits":1,"url":"https://github.com/dhayab"},{"name":"Kimjipang","username":"Kimjipang","email":"91196025+Kimjipang@users.noreply.github.com","commits":1,"url":"https://github.com/Kimjipang"},{"name":"Haroen Viaene","username":"","email":"hello@haroen.me","commits":1}],"changelog":[{"hash":"34486ea329b957faa4e41648ff74ea7ca3195961","time":1692863988000,"email":"91196025+Kimjipang@users.noreply.github.com","author":"김지환","message":"docs: update getting-started.md (#1003)","coAuthors":[{"name":"Haroen Viaene","email":"hello@haroen.me"}]},{"hash":"1ecca95c902aa4218b20f64b8bc0dfb2cd729ae9","time":1673275137000,"email":"154633+dhayab@users.noreply.github.com","author":"Dhaya","message":"docs: document git user config before trigger workflow (#991)"},{"hash":"abae7f2a07f6382857cf7b4c6b9db408a0c3c21f","time":1638866295000,"email":"lulzneko@riotz.works","author":"lulzneko","message":"docs: fix the argument passing in npm script (#966)"},{"hash":"f317502bbe20db8401be81f2e2e6cc0b573d64da","time":1601655656000,"email":"shipjs@test.com","author":"shipjs","message":"update the doc to recomment automation token"},{"hash":"d4c58b1dc684343fa6038c52b314f1020e8e3501","time":1600853369000,"email":"shipjs@test.com","author":"shipjs","message":"docs: add a warning about token"},{"hash":"88f51371ab9d9060ce2306929a4b13afb55c541b","time":1592897828000,"email":"shipjs@test.com","author":"shipjs","message":"docs: add video to the doc"},{"hash":"25ca29eb650bfa23804b18423ccd2927f7e1a3fc","time":1591801944000,"email":"shipjs@test.com","author":"shipjs","message":"chore: update doc"},{"hash":"b590000152d9764fba9b5e51930bb16470239426","time":1591557578000,"email":"shipjs@test.com","author":"shipjs","message":"docs: update changelog"},{"hash":"7b8b430d73d982ea54c217062aa2db3f284a63d5","time":1591555638000,"email":"eunjae.lee@algolia.com","author":"Eunjae Lee","message":"chore: remove mergeStrategy (#861)","coAuthors":[{"name":"shipjs","email":"shipjs@test.com"}]},{"hash":"f6cb4160f675649ea84c03f63fc31780067dc487","time":1590433887000,"email":"eunjae.lee@algolia.com","author":"Eunjae Lee","message":"docs: update guide on script (#839)"},{"hash":"8ab4fad74faf5c5cb854287b06224cc3508c3846","time":1583874087000,"email":"eunjae.lee@algolia.com","author":"Eunjae Lee","message":"docs: update guide (#718)","coAuthors":[{"name":"shipjs","email":"shipjs@test.com"}]},{"hash":"77b4569759111ae8fa50922dcf952d2730a41865","time":1577825148000,"email":"eunjae.lee@algolia.com","author":"Eunjae Lee","message":"docs: add warning for npm 2fa (#579)"},{"hash":"835e26f6d61813b46abd8c028e9b166c351adcab","time":1577630227000,"email":"jeetiss@yandex.ru","author":"Dmitry Ivakhnenko","message":"fix: replace GH_TOKEN with GITHUB_TOKEN (#568)","coAuthors":[{"name":"Eunjae Lee","email":"karis612@gmail.com"}]},{"hash":"7159ae431c92a5b7e2c75a7aa521b88f0c71fdc3","time":1576847687000,"email":"eunjae.lee@algolia.com","author":"Eunjae Lee","message":"docs: add a section for GitHub Actions (#533)","coAuthors":[{"name":"Dmitry Ivakhnenko","email":"jeetiss@yandex.ru"}]},{"hash":"86036e89f250a74fb72b736731e4fc11169e0812","time":1575630413000,"email":"eunjae.lee@algolia.com","author":"Eunjae Lee","message":"docs: update getting started (#511)"},{"hash":"39f8aa349c353c1963f32ccc8d751b39e99c3e6c","time":1575494285000,"email":"eunjae.lee@algolia.com","author":"Eunjae Lee","message":"docs: update readme (#503)"},{"hash":"6ddec2f625568e956b0820fac6f770984e52d4a4","time":1575417749000,"email":"eunjae.lee@algolia.com","author":"Eunjae Lee","message":"docs: add website (#397)"}]},"filePathRelative":"guide/getting-started.md"}');export{v as comp,f as data};
