import{_ as i,c as o,b as n,a as s,d as a,e as l,w as r,r as p,o as u}from"./app-CShXt8eO.js";const c="/shipjs/assets/setup-rESOHHLC.png",d="/shipjs/assets/automation-token-XFWi_sWw.png",h={},m={class:"hint-container warning"};function g(k,e){const t=p("RouteLink");return u(),o("div",null,[e[5]||(e[5]=n("h1",{id:"getting-started",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#getting-started"},[n("span",null,"Getting Started")])],-1)),e[6]||(e[6]=n("p",null,"You can following the guide below, or watch this video.",-1)),e[7]||(e[7]=n("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/FPj7urChN_E",frameborder:"0",allow:"autoplay; encrypted-media",allowfullscreen:""},null,-1)),e[8]||(e[8]=s(`<h2 id="installation" tabindex="-1"><a class="header-anchor" href="#installation"><span>Installation</span></a></h2><p>Running the following command will guide you to set it up interactively.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">npx shipjs setup</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>This interactive CLI will help you install Ship.js into your package and create a tailored config file for your project.</p><p><img src="`+c+`" alt="npx shipjs setup"></p><p>Otherwise, you can still do it manually.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">npm</span> <span class="token function">install</span> --save-dev shipjs</span>
<span class="line"></span>
<span class="line">or</span>
<span class="line"></span>
<span class="line"><span class="token function">yarn</span> <span class="token function">add</span> <span class="token parameter variable">-D</span> shipjs</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Add the following to the <code>scripts</code> section in your <code>package.json</code>.</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">&quot;scripts<span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">//...</span></span>
<span class="line">  <span class="token string-property property">&quot;release&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shipjs prepare&quot;</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="github-token" tabindex="-1"><a class="header-anchor" href="#github-token"><span>GitHub Token</span></a></h3>`,10)),n("div",m,[e[3]||(e[3]=s(`<p class="hint-container-title">If you use Ship.js at work, I recommend you to get a token from a shared account, not from your personal account because after you quit, your token will still be used. :::</p><p>GitHub token is used in both <code>shipjs prepare</code> and <code>shipjs trigger</code>.</p><ol><li>Go to <a href="https://github.com/settings/tokens/new" target="_blank" rel="noopener noreferrer">https://github.com/settings/tokens/new</a></li><li>Check &quot;repo(Full control of private repositories)&quot;</li><li>Generate/copy the token</li></ol><p>You can put it in the following two ways:</p><ul><li>Prepend it in your command like: <code>GITHUB_TOKEN=xxx shipjs prepare</code></li><li>Create a file named &quot;.env&quot; and put the following content: <code>GITHUB_TOKEN=xxx</code> (&quot;.env&quot; should not be committed. Add it to &quot;.gitignore&quot;.)</li></ul><p>If you automate flows in your CI, you can add the token to Environment Variable section in your CI service.</p><h3 id="dry-mode" tabindex="-1"><a class="header-anchor" href="#dry-mode"><span>Dry Mode</span></a></h3><p>If you&#39;re not sure, you can always run commands in dry mode.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">yarn</span> run release --dry-run</span>
<span class="line"><span class="token comment"># or</span></span>
<span class="line"><span class="token function">npm</span> run release -- --dry-run</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>It will show you which steps are going to be executed without actually executing them.</p><h2 id="on-your-local-machine" tabindex="-1"><a class="header-anchor" href="#on-your-local-machine"><span>On your local machine</span></a></h2><ul><li>Part 1: <code>yarn run release</code> will create a pull request.</li><li>Part 2: Review and merge the PR.</li><li>Part 3: <code>git pull</code> and <code>yarn shipjs trigger</code>(or <code>npx shipjs trigger</code>) to actually publish it to NPM.</li></ul><h2 id="automate-part-3-trigger" tabindex="-1"><a class="header-anchor" href="#automate-part-3-trigger"><span>Automate Part 3 (<code>trigger</code>)</span></a></h2><p>This guide is based on CircleCI. It may be done similarly on other CI services.</p>`,14)),n("p",null,[e[1]||(e[1]=a("If you are using GitHub Actions, you can jump to ",-1)),l(t,{to:"/guide/getting-started.html#setup-github-actions"},{default:r(()=>[...e[0]||(e[0]=[a("Setup GitHub Actions",-1)])]),_:1}),e[2]||(e[2]=a(".",-1))]),e[4]||(e[4]=s(`<p>A minimal <code>.circleci/config.yml</code> looks like the following:</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token number">2</span></span>
<span class="line"><span class="token key atrule">jobs</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">shipjs_trigger</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">docker</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> <span class="token string">&#39;circleci/node:latest&#39;</span></span>
<span class="line">    <span class="token key atrule">steps</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> checkout</span>
<span class="line">      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span></span>
<span class="line">          <span class="token key atrule">name</span><span class="token punctuation">:</span> Install</span>
<span class="line">          <span class="token key atrule">command</span><span class="token punctuation">:</span> yarn install</span>
<span class="line">      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span></span>
<span class="line">          <span class="token key atrule">name</span><span class="token punctuation">:</span> Triggering Ship.js to Release</span>
<span class="line">          <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string"></span>
<span class="line">            git config --global user.email &quot;you@example.com&quot;</span>
<span class="line">            git config --global user.name &quot;Your Name&quot;</span>
<span class="line">            yarn shipjs trigger</span></span>
<span class="line"><span class="token key atrule">workflows</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token number">2</span></span>
<span class="line">  <span class="token key atrule">release_if_needed</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">jobs</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token key atrule">shipjs_trigger</span><span class="token punctuation">:</span></span>
<span class="line">          <span class="token key atrule">filters</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token key atrule">branches</span><span class="token punctuation">:</span></span>
<span class="line">              <span class="token key atrule">only</span><span class="token punctuation">:</span></span>
<span class="line">                <span class="token punctuation">-</span> master <span class="token comment"># or whatever branch you&#39;d like (normally your base branch)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>At Part 2, if you merge the PR, a new commit will be added and CircleCI will run <code>yarn shipjs trigger</code>(or <code>npx shipjs trigger</code>). Then, it will check if the latest commit message is in convention and the current branch is right. If the conditions are met, it will trigger a release. Otherwise, it will skip.</p><p>When merging a PR, you need to &quot;Squash and merge&quot; into a single commit.</p><p>You can go to &quot;Settings&quot; menu of your repository, and even force &quot;Squash and merge&quot; behavior under &quot;Merge button&quot; section.</p><p>To learn more, you can read <a href="https://help.github.com/en/github/collaborating-with-issues-and-pull-requests/about-pull-request-merges#squash-and-merge-your-pull-request-commits" target="_blank" rel="noopener noreferrer">this</a>.</p><h3 id="npm-token" tabindex="-1"><a class="header-anchor" href="#npm-token"><span>NPM Token</span></a></h3><p>Setup an NPM token to allow Ship.js(<strong>at CircleCI</strong>) to release the package to NPM.</p><ol><li>Login at <a href="https://www.npmjs.com/" target="_blank" rel="noopener noreferrer">https://www.npmjs.com/</a>, click your profile icon and go to &quot;Tokens&quot;.</li><li>Click &quot;Create New Token&quot;, make sure the access level is &quot;Read and Publish&quot; and copy the token.</li><li>At CircleCI, go to &quot;Project Settings&quot; → &quot;BUILD SETTINGS&quot; → &quot;Environment Variables&quot;.</li><li>Click &quot;Add Variable&quot;. <ul><li>Name: <code>NPM_AUTH_TOKEN</code></li><li>Value: Paste the token from clipboard.</li></ul></li></ol><div class="hint-container warning"><p class="hint-container-title">WARNING for 2FA If you have enabled 2FA for both authorization and publishing, when <code>shipjs trigger</code> runs, it will be prompted for one-time password. You probably have configured CI service (CircleCI, GitHub Actions, etc) to run that command for you. It means <code>shipjs trigger</code> will be stuck.</p><p>NPM has <a href="https://github.blog/changelog/2020-10-02-npm-automation-tokens/" target="_blank" rel="noopener noreferrer">released</a> a new feature &quot;Automation token&quot; to solve this.</p><p><img src="`+d+`" alt="NPM automation token"> :::</p><h3 id="github-token-1" tabindex="-1"><a class="header-anchor" href="#github-token-1"><span>GitHub Token</span></a></h3><p>Setup a GitHub token to allow Ship.js(<strong>at CircleCI</strong>) to create a git tag and push it to remote after release.</p><ol><li>Go to https://github.com/settings/tokens/new</li><li>Check &quot;repo(Full control of private repositories)&quot;</li><li>Generate/copy the token</li><li>At CircleCI, go to &quot;Project Settings&quot; → &quot;BUILD SETTINGS&quot; → &quot;Environment Variables&quot;.</li><li>Click &quot;Add Variable&quot;. <ul><li>Name: <code>GITHUB_TOKEN</code></li><li>Value: Paste the token from clipboard.</li></ul></li></ol><h2 id="setup-github-actions" tabindex="-1"><a class="header-anchor" href="#setup-github-actions"><span>Setup GitHub Actions</span></a></h2><p>If you are using GitHub Actions, you need to setup the NPM token to release package to NPM:</p><ol><li>Login at <a href="https://www.npmjs.com/" target="_blank" rel="noopener noreferrer">https://www.npmjs.com/</a>, click your profile icon and go to &quot;Auth Tokens&quot;.</li><li>Click &quot;Create New Token&quot;, make sure the access level is &quot;Read and Publish&quot; and copy the token.</li><li>At your GitHub repo, go to &quot;Settings&quot; → &quot;Secrets&quot;.</li><li>Click &quot;Add a new secret&quot;. <ul><li>Name: <code>NPM_AUTH_TOKEN</code></li><li>Value: Paste the token from clipboard.</li></ul></li></ol><p>If you use <a href="/reference/all-config.html#useoidctokenprovider" target="_blank" rel="noopener noreferrer"><code>useOidcTokenProvider</code></a> for npm&#39;s OIDC trusted publishing, add the following permissions to your workflow job:</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token key atrule">permissions</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">id-token</span><span class="token punctuation">:</span> write</span>
<span class="line">  <span class="token key atrule">contents</span><span class="token punctuation">:</span> read</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="setup-with-nothing" tabindex="-1"><a class="header-anchor" href="#setup-with-nothing"><span>Setup with &#39;Nothing&#39;</span></a></h2><p>If you never use any CI environment, you need to use NPM token to release package to NPM:</p><ol><li>Login at <a href="https://www.npmjs.com/" target="_blank" rel="noopener noreferrer">https://www.npmjs.com/</a>, click your profile icon and go to &quot;Auth Tokens&quot;.</li><li>Click &quot;Create New Token&quot;, make sure the access level is &quot;Read and Publish&quot; and copy the token.</li></ol><p>You can put it in the following two ways:</p><ul><li>Prepend it in your command like: <code>NPM_AUTH_TOKEN=xxx shipjs trigger</code></li><li>Create a file named &quot;.env&quot; and put the following content: <code>NPM_AUTH_TOKEN=xxx</code> (&quot;.env&quot; should not be committed. Add it to &quot;.gitignore&quot;.)</li></ul></div>`,10))])])}const v=i(h,[["render",g]]),y=JSON.parse('{"path":"/guide/getting-started.html","title":"Getting Started","lang":"en-US","frontmatter":{},"git":{"updatedTime":1770220825000,"contributors":[{"name":"sarahdayan","username":"sarahdayan","email":"5370675+sarahdayan@users.noreply.github.com","commits":1,"url":"https://github.com/sarahdayan"},{"name":"Claude Opus 4.5","username":"","email":"noreply@anthropic.com","commits":1}],"changelog":[{"hash":"54ee34aa9e8796f99575b8c97f6cd6ae34d92b8b","time":1770220825000,"email":"5370675+sarahdayan@users.noreply.github.com","author":"Sarah Dayan","message":"fix(gh-pages): use GITHUB_TOKEN for authentication (#1036)","coAuthors":[{"name":"Claude Opus 4.5","email":"noreply@anthropic.com"}]}]},"filePathRelative":"guide/getting-started.md"}');export{v as comp,y as data};
